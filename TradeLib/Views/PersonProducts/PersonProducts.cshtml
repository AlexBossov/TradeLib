@model TradeLib.Models.Context

@{ 
    ViewData["Title"] = "Your products";
}

@{
    <div>
        <table>
            @{ byte i = 0; }
            @foreach (var prod in Model.PersonProductsModels.ToList())
            {
                if (prod.ProductId == null || prod.PersonId == null) continue;
                var person = await Model.Persons.FindAsync(prod.PersonId);
                if (person?.Email != User.Identity?.Name) continue;
                var product = await Model.Products.FindAsync(prod.ProductId);
                <td type="button" onclick="location.href='https://localhost:5001/Product/ShowProduct/@product?.Id'" class="product">
                    @if (product?.Image is not null)
                    {
                        <img src="data:image;base64,@Convert.ToBase64String(product.Image)" alt="@product.Name" height="350" weight="350"/>
                        <br/>
                    }
                    Name: @product?.Name <br/>
                    Price: @product?.Price <br/>
                </td>
                i++;
                if (i == 4)
                {
                    i = 0;
                    <tr></tr>
                }
            }
        </table>
    </div>
}

